# æ¨¡å‹å®ç°çŠ¶æ€åˆ†æ

## å½“å‰å®ç°æƒ…å†µ

### âœ… å·²å®ç°éƒ¨åˆ†

#### 1. åŸºç¡€å¤§æ¨¡å‹ï¼ˆéƒ¨åˆ†å®ç°ï¼‰
- **ä½ç½®**ï¼š`backend/engine/llm_service.py`
- **å®ç°**ï¼š
  - âœ… OpenAI GPTç³»åˆ—ï¼ˆGPT-4-turboï¼‰APIè°ƒç”¨
  - âœ… DeepSeek APIè°ƒç”¨
  - âœ… åŸºç¡€å°è£…å’ŒæœåŠ¡æ¥å£
- **ç¼ºå¤±**ï¼š
  - âŒ é‡‘èé¢†åŸŸæ•°æ®çš„å¾®è°ƒè®­ç»ƒ
  - âŒ æœ¬åœ°æ¨¡å‹åŠ è½½å’Œæ¨ç†
  - âŒ æ¨¡å‹ç®¡ç†å’Œåˆ‡æ¢

#### 2. é…ç½®æ¡†æ¶ï¼ˆå·²æ­å»ºï¼‰
- **ä½ç½®**ï¼š`config/model_config.yaml`
- **å®ç°**ï¼š
  - âœ… æ¨¡å‹é…ç½®ç»“æ„
  - âœ… æœ¬åœ°æ¨¡å‹é…ç½®å ä½ç¬¦
- **ç¼ºå¤±**ï¼š
  - âŒ å®é™…æ¨¡å‹åŠ è½½é€»è¾‘

### âŒ æœªå®ç°éƒ¨åˆ†

#### 1. LoRAå¾®è°ƒ
- **çŠ¶æ€**ï¼šå®Œå…¨ç¼ºå¤±
- **éœ€è¦å®ç°**ï¼š
  - LoRAè®­ç»ƒè„šæœ¬
  - æ¨¡å‹å¾®è°ƒæµç¨‹
  - é‡‘èé¢†åŸŸè¯­æ–™å‡†å¤‡ï¼ˆ10ä¸‡+æ¡æ ‡æ³¨æ•°æ®ï¼‰
  - å¾®è°ƒæ¨¡å‹åŠ è½½å’Œæ¨ç†

#### 2. è¾…åŠ©å°æ¨¡å‹

##### Rerankeræ¨¡å‹ï¼ˆBERTå¾®è°ƒï¼‰
- **ä½ç½®**ï¼š`backend/engine/retrieval.py` çš„ `_rerank` æ–¹æ³•
- **å½“å‰å®ç°**ï¼šä½¿ç”¨LLMè¿›è¡Œé‡æ’åºï¼ˆç®€åŒ–ç‰ˆï¼‰
- **ç¼ºå¤±**ï¼šçœŸæ­£çš„BERTå¾®è°ƒRerankeræ¨¡å‹

##### NERå’Œå…³ç³»æŠ½å–æ¨¡å‹ï¼ˆSpanBERTï¼‰
- **ä½ç½®**ï¼š`backend/engine/coordinator.py` çš„å®ä½“æå–æ–¹æ³•
- **å½“å‰å®ç°**ï¼šç®€å•çš„å…³é”®è¯åŒ¹é…
- **ç¼ºå¤±**ï¼šçœŸæ­£çš„NERæ¨¡å‹å’Œå…³ç³»æŠ½å–æ¨¡å‹

##### å½’å› åˆ†ææ¨¡å‹ï¼ˆXGBoostï¼‰
- **ä½ç½®**ï¼š`backend/services/analysis_service.py` çš„ `analyze_attribution` æ–¹æ³•
- **å½“å‰å®ç°**ï¼šä½¿ç”¨LLMè¿›è¡Œå½’å› åˆ†æ
- **ç¼ºå¤±**ï¼šXGBoostç­‰ä¼ ç»Ÿæœºå™¨å­¦ä¹ æ¨¡å‹

#### 3. å¤šæ¨¡æ€æ¨¡å‹ï¼ˆGPT-4V/LLaVAï¼‰
- **ä½ç½®**ï¼š`backend/data/processor.py`
- **å½“å‰å®ç°**ï¼šåŸºç¡€çš„OCRï¼ˆTesseractï¼‰
- **ç¼ºå¤±**ï¼š
  - GPT-4Vé›†æˆï¼ˆå›¾è¡¨è§£æï¼‰
  - LLaVAé›†æˆï¼ˆå¤šæ¨¡æ€ç†è§£ï¼‰
  - å›¾ç‰‡å‹è´¢æŠ¥æ•°æ®çš„ç»“æ„åŒ–è½¬æ¢

---

## âœ… å·²è¡¥å……çš„å®ç°

### 1. LoRAå¾®è°ƒæ¨¡å—
- **ä½ç½®**ï¼š`backend/models/finetune/lora_trainer.py`
- **åŠŸèƒ½**ï¼š
  - âœ… LoRAé…ç½®å’Œè®­ç»ƒæ¡†æ¶
  - âœ… æ¨¡å‹åŠ è½½å’Œæ¨ç†
  - âœ… é‡‘èé¢†åŸŸæ•°æ®å‡†å¤‡æ¥å£
- **ä½¿ç”¨**ï¼šéœ€è¦å‡†å¤‡10ä¸‡+æ¡æ ‡æ³¨æ•°æ®ï¼Œè¿è¡Œè®­ç»ƒè„šæœ¬

### 2. BERT Rerankeræ¨¡å‹
- **ä½ç½®**ï¼š`backend/models/reranker/bert_reranker.py`
- **åŠŸèƒ½**ï¼š
  - âœ… BERTå¾®è°ƒRerankeræ¨¡å‹
  - âœ… æ‰¹é‡ç›¸å…³æ€§è®¡ç®—
  - âœ… é›†æˆåˆ°æ£€ç´¢å¼•æ“
- **é›†æˆ**ï¼šå·²åœ¨ `backend/engine/retrieval.py` ä¸­é›†æˆ

### 3. NERå’Œå…³ç³»æŠ½å–æ¨¡å‹
- **ä½ç½®**ï¼š`backend/models/ner/financial_ner.py`
- **åŠŸèƒ½**ï¼š
  - âœ… é‡‘èé¢†åŸŸNERæ¨¡å‹æ¡†æ¶
  - âœ… å®ä½“æå–ï¼ˆå…¬å¸ã€æŒ‡æ ‡ã€æ•°å€¼ã€æ—¶é—´ï¼‰
  - âœ… å…³ç³»æŠ½å–ï¼ˆä¸‰å…ƒç»„æ„å»ºï¼‰
- **ä½¿ç”¨**ï¼šéœ€è¦è®­ç»ƒæˆ–åŠ è½½é¢„è®­ç»ƒçš„é‡‘èé¢†åŸŸNERæ¨¡å‹

### 4. XGBoostå½’å› åˆ†ææ¨¡å‹
- **ä½ç½®**ï¼š`backend/models/attribution/xgboost_attribution.py`
- **åŠŸèƒ½**ï¼š
  - âœ… XGBoostæ¨¡å‹è®­ç»ƒæ¡†æ¶
  - âœ… ç‰¹å¾é‡è¦æ€§åˆ†æ
  - âœ… å½’å› åˆ†æï¼ˆè´¡çŒ®åº¦è®¡ç®—ï¼‰
- **é›†æˆ**ï¼šå·²åœ¨ `backend/services/analysis_service.py` ä¸­é›†æˆ

### 5. å¤šæ¨¡æ€å›¾è¡¨è§£æ
- **ä½ç½®**ï¼š`backend/models/multimodal/chart_parser.py`
- **åŠŸèƒ½**ï¼š
  - âœ… GPT-4Vé›†æˆï¼ˆå›¾è¡¨è§£æï¼‰
  - âœ… LLaVAæ¡†æ¶ï¼ˆå¾…å®ç°æœ¬åœ°éƒ¨ç½²ï¼‰
  - âœ… ç»“æ„åŒ–æ•°æ®æå–
- **é›†æˆ**ï¼šå¯åœ¨ `backend/data/processor.py` ä¸­ä½¿ç”¨

### 6. å¾®è°ƒæ¨¡å‹é›†æˆ
- **ä½ç½®**ï¼š`backend/engine/llm_service.py`
- **åŠŸèƒ½**ï¼š
  - âœ… LoRAå¾®è°ƒæ¨¡å‹åŠ è½½
  - âœ… æ¨¡å‹åˆ‡æ¢é€»è¾‘ï¼ˆAPIæ¨¡å‹ vs å¾®è°ƒæ¨¡å‹ï¼‰
  - âœ… é‡‘èé¢†åŸŸä¼˜å…ˆä½¿ç”¨å¾®è°ƒæ¨¡å‹

---

## ğŸ“‹ ä½¿ç”¨è¯´æ˜

### è®­ç»ƒLoRAæ¨¡å‹
```python
from backend.models.finetune.lora_trainer import LoRATrainer

trainer = LoRATrainer()
trainer.load_base_model()
dataset = trainer.prepare_training_data("data/training_data.json")
trainer.train(dataset, num_epochs=3)
```

### ä½¿ç”¨Rerankeræ¨¡å‹
å·²åœ¨æ£€ç´¢å¼•æ“ä¸­è‡ªåŠ¨é›†æˆï¼Œæ— éœ€é¢å¤–è°ƒç”¨ã€‚

### ä½¿ç”¨NERæ¨¡å‹
```python
from backend.models.ner.financial_ner import FinancialNER

ner = FinancialNER()
entities = ner.extract_entities("æ‹›å•†é“¶è¡Œ2023å¹´ä¸è‰¯ç‡1.5%")
relations = ner.extract_relations(text, entities)
```

### ä½¿ç”¨å½’å› åˆ†ææ¨¡å‹
```python
from backend.models.attribution.xgboost_attribution import XGBoostAttributionModel

model = XGBoostAttributionModel()
model.load_model()  # åŠ è½½å·²è®­ç»ƒçš„æ¨¡å‹
result = model.analyze_attribution(features)
```

### ä½¿ç”¨å›¾è¡¨è§£æ
```python
from backend.models.multimodal.chart_parser import ChartParser

parser = ChartParser()
result = await parser.parse_chart("chart.png", chart_type="bar")
```

---

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **æ¨¡å‹è®­ç»ƒæ•°æ®**ï¼šéœ€è¦å‡†å¤‡å¤§é‡æ ‡æ³¨æ•°æ®ï¼ˆ10ä¸‡+æ¡ï¼‰
2. **è®¡ç®—èµ„æº**ï¼šLoRAè®­ç»ƒéœ€è¦GPUï¼Œå»ºè®®ä½¿ç”¨CUDA
3. **æ¨¡å‹éƒ¨ç½²**ï¼šå¾®è°ƒæ¨¡å‹éœ€è¦æœ¬åœ°éƒ¨ç½²ï¼Œå¢åŠ è®¡ç®—æˆæœ¬
4. **æ€§èƒ½è€ƒè™‘**ï¼šæœ¬åœ°æ¨¡å‹æ¨ç†é€Ÿåº¦å¯èƒ½è¾ƒæ…¢ï¼Œå»ºè®®ä½¿ç”¨ç¼“å­˜
5. **æ¨¡å‹ç‰ˆæœ¬**ï¼šéœ€è¦å®šæœŸæ›´æ–°å’Œé‡æ–°è®­ç»ƒæ¨¡å‹

---

## ğŸ“ ä¸‹ä¸€æ­¥å·¥ä½œ

1. **æ•°æ®å‡†å¤‡**ï¼š
   - æ”¶é›†é‡‘èé¢†åŸŸè¯­æ–™ï¼ˆè´¢æŠ¥ã€æ”¿ç­–ã€è§„åˆ™ç­‰ï¼‰
   - æ ‡æ³¨è®­ç»ƒæ•°æ®ï¼ˆ10ä¸‡+æ¡ï¼‰
   - å‡†å¤‡æµ‹è¯•æ•°æ®é›†

2. **æ¨¡å‹è®­ç»ƒ**ï¼š
   - è®­ç»ƒLoRAå¾®è°ƒæ¨¡å‹
   - å¾®è°ƒBERT Rerankeræ¨¡å‹
   - è®­ç»ƒé‡‘èé¢†åŸŸNERæ¨¡å‹
   - è®­ç»ƒXGBoostå½’å› æ¨¡å‹

3. **æ¨¡å‹ä¼˜åŒ–**ï¼š
   - æ¨¡å‹æ€§èƒ½æµ‹è¯•
   - å‡†ç¡®ç‡è¯„ä¼°å’Œä¼˜åŒ–
   - æ¨ç†é€Ÿåº¦ä¼˜åŒ–

